name: Test GitHub Action

on:
  push:
    branches: [main, 'copilot/**']
  pull_request:
    branches: [main]

jobs:
  test-action:
    name: Test LaTeX Action
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Test LaTeX Build Action
        id: latex_build
        uses: ./
        with:
          entry_tex: "main.tex"
          engine: "pdflatex"
          create_release: false  # Don't create releases for tests
          push_to_releases_branch: false
          keep_build_artifacts: true
          
      - name: Verify outputs
        run: |
          echo "Generated PDFs: ${{ steps.latex_build.outputs.pdf_files }}"
          echo "PDF files exist:"
          ls -la *.pdf || echo "No PDF files found in root"
          ls -la ./*.pdf || echo "No PDF files found in current directory"
          
      - name: Check if PDF was created
        run: |
          if [ -f "main.pdf" ]; then
            echo "✅ main.pdf was successfully created"
            file main.pdf
          else
            echo "❌ main.pdf was not created"
            exit 1
          fi
